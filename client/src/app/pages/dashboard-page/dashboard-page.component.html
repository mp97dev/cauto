<h1>Preventivi</h1>
@if((data | async); as data) {

    <mat-table [dataSource]="data" class="mat-elevation-z8">
        
        @for(c of displayColumns; track c) {
            <ng-container [matColumnDef]="c">
                <mat-header-cell *matHeaderCellDef>{{c}}</mat-header-cell>
                <mat-cell *matCellDef="let row">{{row[c]}}</mat-cell>
            </ng-container>
        }

        <ng-container [matColumnDef]="'action'">
            <mat-header-cell *matHeaderCellDef></mat-header-cell>
            <mat-cell *matCellDef="let row">

                <button mat-icon-button [matMenuTriggerFor]="menu">
                    <mat-icon>more_vert</mat-icon>
                </button>
                <mat-menu #menu="matMenu">
                    <button mat-menu-item (click)="acconto(row)"><mat-icon>attach_money</mat-icon> Acconto </button>
                    @if((user | async)?.role === 'impiegato') {
                        <button mat-menu-item (click)="valutaUsato(row)" [disabled]="!row.usato"><mat-icon>recycling</mat-icon> Valutazione </button>
                        <button mat-menu-item (click)="elimina(row)"><mat-icon>delete</mat-icon> Elimina</button>
                    }
                </mat-menu>
            </mat-cell>
        </ng-container>
        
        <mat-header-row *matHeaderRowDef="columns; sticky: true"></mat-header-row>
        <mat-row *matRowDef="let row; columns: columns;" class="cursor-pointer"></mat-row>
    </mat-table>

}